<!--
2019-03-08
AFFECTSSTOCK in LEDGER Master set to Yes
-->
<!-- These XML tags are added to Excel sheet at run-time by UDIMAGIC  -->
<XMLTAGS CELLREFERENCE="CZ1" XXX="3" xmlns:UDF="TallyUDF">
	<!-- Specifies that this (i.e Column as mentioned above) is the key field -->
	<COLUMNNAME.LIST>
		<COLUMNNAME>ID</COLUMNNAME>
		<COLUMNNAME>NAME</COLUMNNAME>
	</COLUMNNAME.LIST>
	<!-- For macro -->
	<VBA LOADFILE="Vouchers-GST-Sales-Amazon-macro.txt" RUNMACROATSTARTUP="NewColumns,B#"/>
	<!-- Create VOUCHERTYPE Master -->
	<MASTER TYPE="VOUCHERTYPE">
		<NAME.LIST TYPE="String">
			<NAME FORMULA="=(if(Or(D#=&quot;shipment&quot;,D#=&quot;MFNshipment&quot;),&quot;Amazon Sales&quot;,if(D#=&quot;Cancel&quot;,&quot;Amazon Cancelled&quot;,&quot;Amazon Credit Note&quot;)))"/>
		</NAME.LIST>
		<PARENT FORMULA="=(if(Or(D#=&quot;shipment&quot;,D#=&quot;MFNshipment&quot;,D#=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))"/>
		<!-- Is deemed positive not required -->
		<NUMBERINGMETHOD>Manual</NUMBERINGMETHOD>
		<!-- POS -->
		<USEFORPOSINVOICE SKIP="=Round((null)+(null)+(null)+(null),2)=0">Yes</USEFORPOSINVOICE>
	</MASTER>
	<!-- Create CURRENCY Master -->
	<MASTER TYPE="CURRENCY">
		<ORIGINALNAME FORMULA="=(null)"/>
		<MAILINGNAME FORMULA="=(null) &amp; &quot; Curr&quot;"/>
		<DECIMALPLACES> 2</DECIMALPLACES>
	</MASTER>
	<!-- Create Sales/Purchase Ledgers -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME FORMULA="=if(len(trim((if(AH#=0,&quot;Sales GST Local&quot;,&quot;Sales GST Interstate&quot;) &amp; ((AE#+AF#+AG#+AH#)*100) &amp; &quot;%&quot;)))&gt;0,(if(AH#=0,&quot;Sales GST Local&quot;,&quot;Sales GST Interstate&quot;) &amp; ((AE#+AF#+AG#+AH#)*100) &amp; &quot;%&quot;),if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;debit note&quot;\125,0))),&quot;PURCHASE &quot;,&quot;SALES &quot;) &amp; ((AH#*100)+(AE#*100)+(AF#*100)+(AG#*100)) &amp; &quot;%&quot;)"/>
		</NAME.LIST>
		<PARENT SKIP="=Not(len(trim((null)))=0)" FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;debit note&quot;\125,0))),&quot;Purchase Accounts&quot;,&quot;Sales Accounts&quot;)"/>
		<PARENT FORMULA="=(null)"/>
		<TAXTYPE>Others</TAXTYPE>
		<ISBILLWISEON>No</ISBILLWISEON>
		<ISCOSTCENTRESON FORMULA="=if(len(trim((null)))=0,&quot;No&quot;,&quot;Yes&quot;)"/>
		<!-- Hard coded -->
		<AFFECTSSTOCK>Yes</AFFECTSSTOCK>
		<!--AFFECTSSTOCK FORMULA="=if(And(len(trim(N#))=0,len(trim((null)))=0),&quot;No&quot;,&quot;Yes&quot;)"/-->
		<USEFORVAT>No</USEFORVAT>
		<GSTAPPLICABLE SKIP="=trim((null))=&quot;yes&quot;" FORMULA="=&quot;~[~ Applicable&quot;"/>
		<!-- Type of supply : Goods or Services -->
		<GSTTYPEOFSUPPLY SKIP="=trim((null))=&quot;yes&quot;" FORMULA="=if(And(len(trim(N#))=0,len(trim((null)))=0),&quot;Services&quot;,&quot;Goods&quot;)"/>
	</MASTER>
	<!-- Create Party LEDGER Masters -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME FORMULA="=(&quot;Amazon India&quot;)"/>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<OLDNAME FORMULA="=if(len(trim((null)))=0,(&quot;Amazon India&quot;),(null))"/>
		<PARENT SKIP="=Not(len(trim((null)))=0)" FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;debit note&quot;\125,0))),&quot;Sundry Creditors&quot;,&quot;Sundry Debtors&quot;)"/>
		<PARENT FORMULA="=(null)"/>
		<ISCOSTCENTRESON>No</ISCOSTCENTRESON>
		<ADDITIONALNAME FORMULA="=(&quot;Amazon India&quot;)"/>
		<ISBILLWISEON>Yes</ISBILLWISEON>
		<!-- GST fields for PARTY LEDGER -->
		<GSTREGISTRATIONTYPE SKIP="=trim((null))=&quot;yes&quot;" FORMULA="=if(len(trim((&quot;29AAICA3918J1ZE&quot;)))=0,&quot;Unregistered&quot;,&quot;Regular&quot;)"/>
		<!-- GSTIN / UIN -->
		<PARTYGSTIN SKIP="=trim((null))=&quot;yes&quot;" FORMULA="=trim((&quot;29AAICA3918J1ZE&quot;))"/>
		<COUNTRYNAME SKIP="=len(trim((&quot;Karnataka&quot;)))=0">India</COUNTRYNAME>
		<COUNTRYOFRESIDENCE SKIP="=len(trim((&quot;Karnataka&quot;)))=0">India</COUNTRYOFRESIDENCE>
		<!-- 2017-09-14: STATENAME is converted to proper-case  -->
		<STATENAME FORMULA="=proper(trim((&quot;Karnataka&quot;)))"/>
		<LEDSTATENAME FORMULA="=proper(trim((&quot;Karnataka&quot;)))"/>
	</MASTER>
	<!-- POS Ledgers -->
	<MASTER TYPE="LEDGER" SINGLERECORD="YES">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<PARENT>Sundry Debtors</PARENT>
		<ISBILLWISEON>Yes</ISBILLWISEON>
	</MASTER>
	<MASTER TYPE="LEDGER" SINGLERECORD="YES">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<PARENT>Bank Accounts</PARENT>
		<ISBILLWISEON>Yes</ISBILLWISEON>
	</MASTER>
	<MASTER TYPE="LEDGER" SINGLERECORD="YES">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<PARENT>Bank Accounts</PARENT>
		<ISBILLWISEON>Yes</ISBILLWISEON>
	</MASTER>
	<MASTER TYPE="LEDGER" SINGLERECORD="YES">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<PARENT>Cash-in-hand</PARENT>
		<ISBILLWISEON>Yes</ISBILLWISEON>
	</MASTER>
	<!-- Create Trade discount Master -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME FORMULA="=if(len(trim((null)))=0,if(Round((null),2)=0,&quot;&quot;,&quot;Discount&quot;),(null))"/>
		</NAME.LIST>
		<PARENT>Indirect Expenses</PARENT>
		<ISCOSTCENTRESON>No</ISCOSTCENTRESON>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
		<GSTAPPLICABLE FORMULA="=&quot;~[~ Not Applicable&quot;"/>
		<UDF:VATDEALERNATURE.LIST DESC="`VATDealerNature`" ISLIST="YES" TYPE="String" INDEX="10031">
			<UDF:VATDEALERNATURE DESC="`VATDealerNature`">Discount</UDF:VATDEALERNATURE>
		</UDF:VATDEALERNATURE.LIST>
	</MASTER>
	<!-- Create IGST TAX LEDGER Master -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME FORMULA="=if(len(trim((null)))&gt;0,(null),if(Or(IsError(Round((AH#*100),2)),len(trim((AH#*100)))=0,(AH#*100)=0),&quot;&quot;,&quot;IGST &quot; &amp; (AH#*100) &amp; &quot;%&quot;))"/>
		</NAME.LIST>
		<PARENT SKIP="=Not(len(trim((null)))=0)">Duties &amp; Taxes</PARENT>
		<PARENT FORMULA="=(null)"/>
		<ISCOSTCENTRESON>No</ISCOSTCENTRESON>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
		<GSTAPPLICABLE SKIP="=trim((null))=&quot;yes&quot;" FORMULA="=&quot;~[~ Applicable&quot;"/>
		<GSTDUTYHEAD SKIP="=trim((null))=&quot;yes&quot;">Integrated Tax</GSTDUTYHEAD>
		<TAXTYPE SKIP="=trim((null))=&quot;yes&quot;">GST</TAXTYPE>
		<!-- 
      2018-06-28 :Now TAXRATE is included in Tax Ledgers only
      Earlier: TAXRATE not included as it may create confusion 
    -->
		<RATEOFTAXCALCULATION FORMULA="=(AH#*100)"/>
	</MASTER>
	<!-- Create CGST TAX LEDGER Master -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME FORMULA="=if(len(trim((null)))&gt;0,(null),if(Or(IsError(Round((AE#*100),2)),len(trim((AE#*100)))=0,(AE#*100)=0),&quot;&quot;,&quot;CGST &quot; &amp; (AE#*100) &amp; &quot;%&quot;))"/>
		</NAME.LIST>
		<PARENT SKIP="=Not(len(trim((null)))=0)">Duties &amp; Taxes</PARENT>
		<PARENT FORMULA="=(null)"/>
		<ISCOSTCENTRESON>No</ISCOSTCENTRESON>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
		<GSTAPPLICABLE SKIP="=trim((null))=&quot;yes&quot;" FORMULA="=&quot;~[~ Applicable&quot;"/>
		<GSTDUTYHEAD SKIP="=trim((null))=&quot;yes&quot;">Central Tax</GSTDUTYHEAD>
		<TAXTYPE SKIP="=trim((null))=&quot;yes&quot;">GST</TAXTYPE>
		<!-- 
      2018-06-28 :Now TAXRATE is included in Tax Ledgers only
      Earlier: TAXRATE not included as it may create confusion 
    -->
		<RATEOFTAXCALCULATION FORMULA="=(AE#*100)"/>
	</MASTER>
	<!-- Create SGST TAX LEDGER Master -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME FORMULA="=if(len(trim((null)))&gt;0,(null),if(Or(IsError(Round((AF#*100),2)),len(trim((AF#*100)))=0,(AF#*100)=0),&quot;&quot;,&quot;SGST &quot; &amp; (AF#*100) &amp; &quot;%&quot;))"/>
		</NAME.LIST>
		<PARENT SKIP="=Not(len(trim((null)))=0)">Duties &amp; Taxes</PARENT>
		<PARENT FORMULA="=(null)"/>
		<ISCOSTCENTRESON>No</ISCOSTCENTRESON>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
		<GSTAPPLICABLE SKIP="=trim((null))=&quot;yes&quot;" FORMULA="=&quot;~[~ Applicable&quot;"/>
		<GSTDUTYHEAD SKIP="=trim((null))=&quot;yes&quot;">State Tax</GSTDUTYHEAD>
		<TAXTYPE SKIP="=trim((null))=&quot;yes&quot;">GST</TAXTYPE>
		<!-- 
      2018-06-28 :Now TAXRATE is included in Tax Ledgers only
      Earlier: TAXRATE not included as it may create confusion 
    -->
		<RATEOFTAXCALCULATION FORMULA="=(AF#*100)"/>
	</MASTER>
	<!-- Create UT TAX LEDGER Master -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME FORMULA="=if(len(trim((null)))&gt;0,(null),if(Or(IsError(Round((AG#*100),2)),len(trim((AG#*100)))=0,(AG#*100)=0),&quot;&quot;,&quot;UT &quot; &amp; (AG#*100) &amp; &quot;%&quot;))"/>
		</NAME.LIST>
		<PARENT SKIP="=Not(len(trim((null)))=0)">Duties &amp; Taxes</PARENT>
		<PARENT FORMULA="=(null)"/>
		<ISCOSTCENTRESON>No</ISCOSTCENTRESON>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
		<GSTAPPLICABLE SKIP="=trim((null))=&quot;yes&quot;" FORMULA="=&quot;~[~ Applicable&quot;"/>
		<GSTDUTYHEAD SKIP="=trim((null))=&quot;yes&quot;">UT Tax</GSTDUTYHEAD>
		<TAXTYPE SKIP="=trim((null))=&quot;yes&quot;">GST</TAXTYPE>
		<!-- 
      2018-06-28 :Now TAXRATE is included in Tax Ledgers only
      Earlier: TAXRATE not included as it may create confusion 
    -->
		<RATEOFTAXCALCULATION FORMULA="=(AG#*100)"/>
	</MASTER>
	<!-- Create Cess LEDGER Master -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME FORMULA="=if(len(trim((null)))&gt;0,(null),if(Or(IsError(Round((AI#*100),2)),len(trim((AI#*100)))=0,(AI#*100)=0),&quot;&quot;,&quot;Cess &quot; &amp; (AI#*100) &amp; &quot;%&quot;))"/>
		</NAME.LIST>
		<PARENT SKIP="=Not(len(trim((null)))=0)">Duties &amp; Taxes</PARENT>
		<PARENT FORMULA="=(null)"/>
		<ISCOSTCENTRESON>No</ISCOSTCENTRESON>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
		<GSTAPPLICABLE SKIP="=trim((null))=&quot;yes&quot;" FORMULA="=&quot;~[~ Applicable&quot;"/>
		<GSTDUTYHEAD SKIP="=trim((null))=&quot;yes&quot;">Cess</GSTDUTYHEAD>
		<TAXTYPE SKIP="=trim((null))=&quot;yes&quot;">GST</TAXTYPE>
		<CESSVALUATIONMETHOD>Based on Value</CESSVALUATIONMETHOD>
		<!-- 
      2018-06-28 :Now TAXRATE is included in Tax Ledgers only
      Earlier: TAXRATE not included as it may create confusion 
    -->
		<RATEOFTAXCALCULATION FORMULA="=(AI#*100)"/>
	</MASTER>
	<!-- Create Additional Cess LEDGER Master -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME FORMULA="=if(len(trim((null)))&gt;0,(null),if(Or(IsError(Round((null),2)),len(trim((null)))=0,(null)=0),&quot;&quot;,&quot;Addl Cess - &quot; &amp; (null)))"/>
		</NAME.LIST>
		<PARENT SKIP="=Not(len(trim((null)))=0)">Duties &amp; Taxes</PARENT>
		<PARENT FORMULA="=(null)"/>
		<ISCOSTCENTRESON>No</ISCOSTCENTRESON>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
		<GSTAPPLICABLE SKIP="=trim((null))=&quot;yes&quot;" FORMULA="=&quot;~[~ Applicable&quot;"/>
		<GSTDUTYHEAD SKIP="=trim((null))=&quot;yes&quot;">Cess</GSTDUTYHEAD>
		<TAXTYPE SKIP="=trim((null))=&quot;yes&quot;">GST</TAXTYPE>
		<CESSVALUATIONMETHOD>Based on Quantity</CESSVALUATIONMETHOD>
		<!-- 
      2018-06-28 :Now TAXRATE is included in Tax Ledgers only
      Earlier: TAXRATE not included as it may create confusion 
    -->
		<RATEOFTAXCALCULATION FORMULA="=(null)"/>
	</MASTER>
	<!-- Create Other LEDGERs before taxes -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME FORMULA="=(&quot;Shipping Charges @ &quot; &amp; ((AE#+AF#+AG#+AH#)*100) &amp; &quot;%&quot;)"/>
		</NAME.LIST>
		<PARENT>Indirect Expenses</PARENT>
		<ISCOSTCENTRESON FORMULA="=if(len(trim((null)))=0,&quot;No&quot;,&quot;Yes&quot;)"/>
		<TAXTYPE>Others</TAXTYPE>
		<GSTAPPLICABLE>~[~ Not Applicable</GSTAPPLICABLE>
		<APPROPRIATEFOR SKIP="=trim((null))=&quot;yes&quot;">GST</APPROPRIATEFOR>
		<GSTAPPROPRIATETO SKIP="=trim((null))=&quot;yes&quot;">Both</GSTAPPROPRIATETO>
		<EXCISEALLOCTYPE>Based on Value</EXCISEALLOCTYPE>
		<ISEXCISEAPPLICABLE>Yes</ISEXCISEAPPLICABLE>
	</MASTER>
	<!-- Create Other LEDGERs before taxes -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME FORMULA="=(&quot;Gift Wrap Charges @&quot; &amp; ((AE#+AF#+AG#+AH#)*100) &amp; &quot;%&quot;)"/>
		</NAME.LIST>
		<PARENT>Indirect Expenses</PARENT>
		<ISCOSTCENTRESON FORMULA="=if(len(trim((null)))=0,&quot;No&quot;,&quot;Yes&quot;)"/>
		<TAXTYPE>Others</TAXTYPE>
		<GSTAPPLICABLE>~[~ Not Applicable</GSTAPPLICABLE>
		<APPROPRIATEFOR SKIP="=trim((null))=&quot;yes&quot;">GST</APPROPRIATEFOR>
		<GSTAPPROPRIATETO SKIP="=trim((null))=&quot;yes&quot;">Both</GSTAPPROPRIATETO>
		<EXCISEALLOCTYPE>Based on Value</EXCISEALLOCTYPE>
		<ISEXCISEAPPLICABLE>Yes</ISEXCISEAPPLICABLE>
	</MASTER>
	<!-- Create Other LEDGERs before taxes -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<PARENT>Indirect Expenses</PARENT>
		<ISCOSTCENTRESON FORMULA="=if(len(trim((null)))=0,&quot;No&quot;,&quot;Yes&quot;)"/>
		<TAXTYPE>Others</TAXTYPE>
		<GSTAPPLICABLE>~[~ Not Applicable</GSTAPPLICABLE>
		<APPROPRIATEFOR SKIP="=trim((null))=&quot;yes&quot;">GST</APPROPRIATEFOR>
		<GSTAPPROPRIATETO SKIP="=trim((null))=&quot;yes&quot;">Both</GSTAPPROPRIATETO>
		<EXCISEALLOCTYPE>Based on Value</EXCISEALLOCTYPE>
		<ISEXCISEAPPLICABLE>Yes</ISEXCISEAPPLICABLE>
	</MASTER>
	<!-- Create Other LEDGERs before taxes -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<PARENT>Indirect Expenses</PARENT>
		<ISCOSTCENTRESON FORMULA="=if(len(trim((null)))=0,&quot;No&quot;,&quot;Yes&quot;)"/>
		<TAXTYPE>Others</TAXTYPE>
		<GSTAPPLICABLE SKIP="=trim((null))=&quot;yes&quot;">~[~ Not Applicable</GSTAPPLICABLE>
		<APPROPRIATEFOR SKIP="=trim((null))=&quot;yes&quot;">GST</APPROPRIATEFOR>
		<GSTAPPROPRIATETO>Both</GSTAPPROPRIATETO>
		<EXCISEALLOCTYPE>Based on Value</EXCISEALLOCTYPE>
		<ISEXCISEAPPLICABLE>Yes</ISEXCISEAPPLICABLE>
	</MASTER>
	<!-- Create Other LEDGERs before taxes -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<PARENT>Indirect Expenses</PARENT>
		<ISCOSTCENTRESON FORMULA="=if(len(trim((null)))=0,&quot;No&quot;,&quot;Yes&quot;)"/>
		<TAXTYPE>Others</TAXTYPE>
		<GSTAPPLICABLE SKIP="=trim((null))=&quot;yes&quot;">~[~ Not Applicable</GSTAPPLICABLE>
		<APPROPRIATEFOR SKIP="=trim((null))=&quot;yes&quot;">GST</APPROPRIATEFOR>
		<GSTAPPROPRIATETO>Both</GSTAPPROPRIATETO>
		<EXCISEALLOCTYPE>Based on Value</EXCISEALLOCTYPE>
		<ISEXCISEAPPLICABLE>Yes</ISEXCISEAPPLICABLE>
	</MASTER>
	<!-- Create Other LEDGERs after taxes -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<PARENT>Indirect Expenses</PARENT>
		<ISCOSTCENTRESON FORMULA="=if(len(trim((null)))=0,&quot;No&quot;,&quot;Yes&quot;)"/>
	</MASTER>
	<!-- Create Other LEDGERs after taxes -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<PARENT>Indirect Expenses</PARENT>
		<ISCOSTCENTRESON FORMULA="=if(len(trim((null)))=0,&quot;No&quot;,&quot;Yes&quot;)"/>
	</MASTER>
	<!-- Create Other LEDGERs after taxes -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<PARENT>Indirect Expenses</PARENT>
		<ISCOSTCENTRESON FORMULA="=if(len(trim((null)))=0,&quot;No&quot;,&quot;Yes&quot;)"/>
	</MASTER>
	<!-- Create Other LEDGERs after taxes -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<PARENT>Indirect Expenses</PARENT>
		<ISCOSTCENTRESON FORMULA="=if(len(trim((null)))=0,&quot;No&quot;,&quot;Yes&quot;)"/>
	</MASTER>
	<!-- Create Other LEDGERs after taxes -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<PARENT>Indirect Expenses</PARENT>
		<ISCOSTCENTRESON FORMULA="=if(len(trim((null)))=0,&quot;No&quot;,&quot;Yes&quot;)"/>
	</MASTER>
	<!-- Create Round Off LEDGER Master -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME FORMULA="=if(len(trim((null)))=0,&quot;Round Off&quot;,(null))"/>
		</NAME.LIST>
		<PARENT>Indirect Expenses</PARENT>
		<ISCOSTCENTRESON>No</ISCOSTCENTRESON>
	</MASTER>
	<!-- Cost Category -->
	<MASTER TYPE="COSTCATEGORY">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
		<ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
	</MASTER>
	<!-- Cost Centre -->
	<MASTER TYPE="COSTCENTRE">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<CATEGORY SKIP="=Len(trim((null)))=0" FORMULA="=(null)"/>
		<REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
	</MASTER>
	<!-- Cost Category -->
	<MASTER TYPE="COSTCATEGORY">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
		<ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
	</MASTER>
	<!-- Cost Centre -->
	<MASTER TYPE="COSTCENTRE">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<CATEGORY SKIP="=Len(trim((null)))=0" FORMULA="=(null)"/>
		<REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
	</MASTER>
	<!-- Cost Category -->
	<MASTER TYPE="COSTCATEGORY">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
		<ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
	</MASTER>
	<!-- Cost Centre -->
	<MASTER TYPE="COSTCENTRE">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<CATEGORY SKIP="=Len(trim((null)))=0" FORMULA="=(null)"/>
		<REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
	</MASTER>
	<!-- Cost Category -->
	<MASTER TYPE="COSTCATEGORY">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
		<ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
	</MASTER>
	<!-- Cost Centre -->
	<MASTER TYPE="COSTCENTRE">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<CATEGORY SKIP="=Len(trim((null)))=0" FORMULA="=(null)"/>
		<REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
	</MASTER>
	<!-- Cost Category -->
	<MASTER TYPE="COSTCATEGORY">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
		<ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
	</MASTER>
	<!-- Cost Centre -->
	<MASTER TYPE="COSTCENTRE">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<CATEGORY SKIP="=Len(trim((null)))=0" FORMULA="=(null)"/>
		<REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
	</MASTER>
	<!-- Cost Category -->
	<MASTER TYPE="COSTCATEGORY">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
		<ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
	</MASTER>
	<!-- Cost Centre -->
	<MASTER TYPE="COSTCENTRE">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<CATEGORY SKIP="=Len(trim((null)))=0" FORMULA="=(null)"/>
		<REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
	</MASTER>
	<!-- Cost Category -->
	<MASTER TYPE="COSTCATEGORY">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
		<ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
	</MASTER>
	<!-- Cost Centre -->
	<MASTER TYPE="COSTCENTRE">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<CATEGORY SKIP="=Len(trim((null)))=0" FORMULA="=(null)"/>
		<REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
	</MASTER>
	<!-- Cost Category -->
	<MASTER TYPE="COSTCATEGORY">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
		<ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
	</MASTER>
	<!-- Cost Centre -->
	<MASTER TYPE="COSTCENTRE">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<CATEGORY SKIP="=Len(trim((null)))=0" FORMULA="=(null)"/>
		<REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
	</MASTER>
	<!-- Cost Category -->
	<MASTER TYPE="COSTCATEGORY">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
		<ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
	</MASTER>
	<!-- Cost Centre -->
	<MASTER TYPE="COSTCENTRE">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<CATEGORY SKIP="=Len(trim((null)))=0" FORMULA="=(null)"/>
		<REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
	</MASTER>
	<!-- Cost Category -->
	<MASTER TYPE="COSTCATEGORY">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
		<ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
	</MASTER>
	<!-- Cost Centre -->
	<MASTER TYPE="COSTCENTRE">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<CATEGORY SKIP="=Len(trim((null)))=0" FORMULA="=(null)"/>
		<REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
	</MASTER>
	<!-- Cost Category -->
	<MASTER TYPE="COSTCATEGORY">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<ALLOCATEREVENUE>Yes</ALLOCATEREVENUE>
		<ALLOCATENONREVENUE>Yes</ALLOCATENONREVENUE>
	</MASTER>
	<!-- Cost Centre -->
	<MASTER TYPE="COSTCENTRE">
		<NAME.LIST>
			<NAME FORMULA="=(null)"/>
		</NAME.LIST>
		<CATEGORY SKIP="=Len(trim((null)))=0" FORMULA="=(null)"/>
		<REVENUELEDFOROPBAL>No</REVENUELEDFOROPBAL>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
	</MASTER>
	<!-- Create UNIT Master -->
	<MASTER TYPE="UNIT">
		<NAME FORMULA="=(&quot;Nos&quot;)"/>
		<ISSIMPLEUNIT>Yes</ISSIMPLEUNIT>
		<GSTREPUOM SKIP="=Not(trim((&quot;Nos&quot;))=&quot;nos&quot;)">NOS-NUMBERS</GSTREPUOM>
		<GSTREPUOM SKIP="=Not(trim((&quot;Nos&quot;))=&quot;kgs&quot;)">KGS-KILOGRAMS</GSTREPUOM>
	</MASTER>
	<!-- Create Godown Masters -->
	<MASTER TYPE="GODOWN">
		<NAME COLUMNREFERENCE="BV"/>
		<PARENT/>
	</MASTER>
	<!-- Create STOCKITEM Masters -->
	<MASTER TYPE="STOCKITEM">
		<OLDNAME FORMULA="=if(len(trim((null)))=0,N#,(null))"/>
		<!-- Overwrite existing ITEMs -->
		<IMPORTDUPS FORMULA="=if(And(Not(IsError((null))),len(trim((null)))&gt;0,(null)=&quot;yes&quot;),&quot;Modify with new data&quot;,&quot;Ignore Duplicates&quot;)"/>
		<!-- Create new item with Name or PartNo -->
		<NAME FORMULA="=if(len(trim(N#))=0,(null),N#)"/>
		<!-- SKIP if both Name and Part No are empty -->
		<ADDITIONALNAME SKIP="=Or(len(trim((null)))=0,len(trim(N#))=0)" FORMULA="=(null)"/>
		<BASEUNITS FORMULA="=(&quot;Nos&quot;)"/>
		<PARENT FORMULA="=(null)"/>
		<ISBATCHWISEON FORMULA="=if((len(trim((null)))+len(trim((null)))+len(trim((null))))=0,&quot;&quot;,&quot;Yes&quot;)"/>
		<HASMFGDATE FORMULA="=if(len(trim((null)))=0,&quot;&quot;,&quot;Yes&quot;)"/>
		<ISPERISHABLEON FORMULA="=if(len(trim((null)))=0,&quot;&quot;,&quot;Yes&quot;)"/>
		<!-- GST details -->
		<GSTAPPLICABLE SKIP="=trim((null))=&quot;yes&quot;" FORMULA="=&quot;~[~ Applicable&quot;"/>
		<!-- Type of supply : Hard coded -->
		<GSTTYPEOFSUPPLY SKIP="=trim((null))=&quot;yes&quot;">Goods</GSTTYPEOFSUPPLY>
		<GSTDETAILS.LIST SKIP="=trim((null))=&quot;yes&quot;">
			<!-- Hard coded -->
			<APPLICABLEFROM>20170701</APPLICABLEFROM>
			<!-- Hard coded -->
			<CALCULATIONTYPE>On Value</CALCULATIONTYPE>
			<!-- HSN Desc -->
			<HSN FORMULA="=(null)"/>
			<!-- HSN Code -->
			<HSNCODE COLUMNREFERENCE="M"/>
			<TAXABILITY FORMULA="=If((AH#*100)+(AE#*100)+(AF#*100)+(AG#*100)+(AI#*100)&gt;0,&quot;Taxable&quot;,&quot;Exempt&quot;)"/>
			<STATEWISEDETAILS.LIST>
				<STATENAME>~[~ Any</STATENAME>
				<RATEDETAILS.LIST>
					<GSTRATEDUTYHEAD>Central Tax</GSTRATEDUTYHEAD>
					<GSTRATEVALUATIONTYPE>Based on Value</GSTRATEVALUATIONTYPE>
					<GSTRATE FORMULA="=If(Round((AE#*100),2)&gt;0,Round((AE#*100),2),If((AH#*100)&gt;0,Round((AH#*100)/2,2),0))"/>
				</RATEDETAILS.LIST>
				<RATEDETAILS.LIST>
					<GSTRATEDUTYHEAD FORMULA="=if(And(Round((AG#*100),2)=0,Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AG#/(AE#+AF#+AG#+AH#+AI#))),2)=0),&quot;State Tax&quot;,&quot;UT Tax&quot;)"/>
					<GSTRATEVALUATIONTYPE>Based on Value</GSTRATEVALUATIONTYPE>
					<GSTRATE SKIP="=And(Round((AF#*100),2)=0,Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AF#/(AE#+AF#+AG#+AH#+AI#))),2)=0,Not(And(Round((AG#*100),2)=0,Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AG#/(AE#+AF#+AG#+AH#+AI#))),2)=0)))" FORMULA="=If((AF#*100)&gt;0,(AF#*100),If((AH#*100)&gt;0,Round((AH#*100)/2,2),0))"/>
					<GSTRATE SKIP="=And(Round((AG#*100),2)=0,Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AG#/(AE#+AF#+AG#+AH#+AI#))),2)=0)" FORMULA="=If((AG#*100)&gt;0,(AG#*100),If((AH#*100)&gt;0,Round((AH#*100)/2,2),0))"/>
				</RATEDETAILS.LIST>
				<RATEDETAILS.LIST>
					<GSTRATEDUTYHEAD>Integrated Tax</GSTRATEDUTYHEAD>
					<GSTRATEVALUATIONTYPE>Based on Value</GSTRATEVALUATIONTYPE>
					<GSTRATE FORMULA="=If(Round((AH#*100),2)&gt;0,Round((AH#*100),2),Round((AE#*100)+(AF#*100),2))"/>
				</RATEDETAILS.LIST>
				<RATEDETAILS.LIST>
					<GSTRATEDUTYHEAD>Cess</GSTRATEDUTYHEAD>
					<GSTRATEVALUATIONTYPE SKIP="=Not(Or(Round((null),2)=0,Round((null),2)=0))">Based on Value</GSTRATEVALUATIONTYPE>
					<GSTRATEVALUATIONTYPE SKIP="=Or(Round((null),2)=0,Round((null),2)=0)">Based on Value and Quantity</GSTRATEVALUATIONTYPE>
					<GSTRATE FORMULA="=if(Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AI#/(AE#+AF#+AG#+AH#+AI#))),2)=0,0,Round((AI#*100),2))"/>
				</RATEDETAILS.LIST>
				<!-- Cess based on Qty -->
				<RATEDETAILS.LIST SKIP="=Or(Round((null),2)=0,Round((null),2)=0)">
					<GSTRATEDUTYHEAD>Cess on Qty</GSTRATEDUTYHEAD>
					<GSTRATEVALUATIONTYPE>Based on Quantity</GSTRATEVALUATIONTYPE>
					<GSTRATE FORMULA="=if(Round((null),2)=0,0,Round((null),2))"/>
				</RATEDETAILS.LIST>
			</STATEWISEDETAILS.LIST>
			<TEMPGSTDETAILSLABRATES.LIST>
			</TEMPGSTDETAILSLABRATES.LIST>
		</GSTDETAILS.LIST>
	</MASTER>
	<VOUCHER10 SKIP="=trim((null))=&quot;Yes&quot;" SUPPRESS_ERROR="NO ENTRIES IN VOUCHER">
		<GUID FORMULA="=+&quot;udi-H6W7QN-&quot; &amp; CZ# &amp; &quot;-&quot; &amp; (if(Or(D#=&quot;shipment&quot;,D#=&quot;MFNshipment&quot;),&quot;Amazon Sales&quot;,if(D#=&quot;Cancel&quot;,&quot;Amazon Cancelled&quot;,&quot;Amazon Credit Note&quot;))) &amp; &quot;-&quot; &amp; (TEXT(C#, &quot;DD/MM/YYYY&quot;))"/>
		<DATE FORMULA="=(TEXT(C#, &quot;DD/MM/YYYY&quot;))"/>
		<EFFECTIVEDATE FORMULA="=(TEXT(C#, &quot;DD/MM/YYYY&quot;))"/>
		<CLASSNAME FORMULA="=(null)"/>
		<VOUCHERTYPENAME FORMULA="=(if(Or(D#=&quot;shipment&quot;,D#=&quot;MFNshipment&quot;),&quot;Amazon Sales&quot;,if(D#=&quot;Cancel&quot;,&quot;Amazon Cancelled&quot;,&quot;Amazon Credit Note&quot;)))"/>
		<VOUCHERNUMBER COLUMNREFERENCE="B"/>
		<REFERENCE FORMULA="=(if(len(trim(CA#))=0,E#,CA#))"/>
		<NARRATION FORMULA="=(null)"/>
		<!-- POS ledgers -->
		<POSCARDLEDGER FORMULA="=(null)"/>
		<POSCASHLEDGER FORMULA="=(null)"/>
		<POSGIFTLEDGER FORMULA="=(null)"/>
		<POSCHEQUELEDGER FORMULA="=(null)"/>
		<!-- POS Cash tendered -->
		<POSCASHRECEIVED FORMULA="=Round({Round((null),2)},if(trim((&quot;Yes&quot;))=&quot;yes&quot;,0,2))*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),1,-1)"/>
		<!-- Other POS details -->
		<POSCARDNUMBER FORMULA="=(null)"/>
		<POSCHEQUENUMBER FORMULA="=(null)"/>
		<POSCHEQUEBANKNAME FORMULA="=(null)"/>
		<ISINVOICE FORMULA="=if(And(len(trim(N#))=0,len(trim((null)))=0),&quot;No&quot;,&quot;Yes&quot;)"/>
		<PERSISTEDVIEW FORMULA="=if(And(len(trim(N#))=0,len(trim((null)))=0),&quot;Accounting Voucher View&quot;,&quot;Invoice Voucher View&quot;)"/>
		<ISINVOICE FORMULA="=(null)"/>
		<PERSISTEDVIEW SKIP="=len(trim((null)))=0" FORMULA="=if(trim((null))=&quot;Yes&quot;,&quot;Invoice Voucher View&quot;,&quot;Accounting Voucher View&quot;)"/>
		<!-- Actual vs Billed qty -->
		<DIFFACTUALQTY FORMULA="=if(len(trim((null)))=0,&quot;No&quot;,&quot;Yes&quot;)"/>
		<!-- For Purchase -->
		<UDF:REFERENCEDATE.LIST DESC="`ReferenceDate`" ISLIST="YES" TYPE="Date">
			<UDF:REFERENCEDATE DESC="`ReferenceDate`" FORMULA="=(if(len(trim(CB#))=0,TEXT(H#, &quot;DD/MM/YYYY&quot;),TEXT(CB#, &quot;DD/MM/YYYY&quot;)))"/>
		</UDF:REFERENCEDATE.LIST>
		<REFERENCEDATE FORMULA="=(if(len(trim(CB#))=0,TEXT(H#, &quot;DD/MM/YYYY&quot;),TEXT(CB#, &quot;DD/MM/YYYY&quot;)))"/>
		<!-- 2017-09-14: Update GSTIN -->
		<PARTYGSTIN SKIP="=trim((null))=&quot;yes&quot;" FORMULA="=if(len(trim((if(len(CD#)=0,&quot;Amazon India&quot;,CD#))))=0,trim((&quot;29AAICA3918J1ZE&quot;)),&quot;&quot;)"/>
		<PARTYGSTIN SKIP="=trim((null))=&quot;yes&quot;" FORMULA="=trim(CE#)"/>
		<!-- 2017-09-14: STATENAME is converted to proper-case  -->
		<STATENAME FORMULA="=proper(if(len(trim((if(len(CD#)=0,&quot;Amazon India&quot;,CD#))))=0,trim((&quot;Karnataka&quot;)),&quot;&quot;))"/>
		<STATENAME FORMULA="=proper(trim((if(len(CF#)=0,Y#,CF#))))"/>
		<PLACEOFSUPPLY FORMULA="=proper(trim((if(len(CF#)=0,Y#,CF#))))"/>
		<GSTREGISTRATIONTYPE SKIP="=Not(len(trim((if(len(CE#)=0,&quot;Consumer&quot;,&quot;Regular&quot;))))=0)" FORMULA="=if(len(trim((&quot;29AAICA3918J1ZE&quot;)))=0,&quot;Unregistered&quot;,&quot;Regular&quot;)"/>
		<GSTREGISTRATIONTYPE FORMULA="=(if(len(CE#)=0,&quot;Consumer&quot;,&quot;Regular&quot;))"/>
		<PARTYLEDGERNAME FORMULA="=(&quot;Amazon India&quot;)"/>
		<BASICBASEPARTYNAME FORMULA="=(&quot;Amazon India&quot;)"/>
		<!-- If Consignee details are NOT empty, then pickup buyer details here -->
		<PARTYNAME FORMULA="=if(len(trim((if(len(CD#)=0,&quot;Amazon India&quot;,CD#))))=0,(&quot;Amazon India&quot;),(if(len(CD#)=0,&quot;Amazon India&quot;,CD#)))"/>
		<!-- Buyer/Supplier details -->
		<ADDRESS.LIST TYPE="String" SKIP="=And(len(trim(X#))=0,len(trim(Y#))=0,len(trim(AA#))=0,len(trim((null)))=0,len(trim((null)))=0)">
			<ADDRESS COLUMNREFERENCE="X"/>
			<ADDRESS COLUMNREFERENCE="Y"/>
			<ADDRESS COLUMNREFERENCE="AA"/>
			<ADDRESS FORMULA="=(null)"/>
			<ADDRESS FORMULA="=(null)"/>
		</ADDRESS.LIST>
		<!-- Consignee details. If Consignee is empty, then show the buyer details for consignee also [For Sales only] -->
		<BASICBUYERNAME FORMULA="=if(len(trim((null)))=0,if((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))=&quot;Sales&quot;,if(len(trim((if(len(CD#)=0,&quot;Amazon India&quot;,CD#))))=0,(&quot;Amazon India&quot;),(if(len(CD#)=0,&quot;Amazon India&quot;,CD#))),&quot;&quot;),(null))"/>
		<BASICBUYERADDRESS.LIST TYPE="String" SKIP="=And(len(trim((null)))=0,len(trim((null)))=0,len(trim((null)))=0,len(trim((null)))=0,len(trim((null)))=0,len(trim((null)))=0,if((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))=&quot;Purchase&quot;,1=1,And(len(trim(X#))=0,len(trim(Y#))=0,len(trim(AA#))=0,len(trim((null)))=0,len(trim((null)))=0)))">
			<BASICBUYERADDRESS FORMULA="=if(len(trim((null)))=0,if((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))=&quot;Sales&quot;,X#,&quot;&quot;),(null))"/>
			<BASICBUYERADDRESS FORMULA="=if(len(trim((null)))=0,if((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))=&quot;Sales&quot;,Y#,&quot;&quot;),(null))"/>
			<BASICBUYERADDRESS FORMULA="=if(len(trim((null)))=0,if((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))=&quot;Sales&quot;,AA#,&quot;&quot;),(null))"/>
			<BASICBUYERADDRESS FORMULA="=if(len(trim((null)))=0,if((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))=&quot;Sales&quot;,(null),&quot;&quot;),(null))"/>
			<BASICBUYERADDRESS FORMULA="=if(len(trim((null)))=0,if((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))=&quot;Sales&quot;,(null),&quot;&quot;),(null))"/>
		</BASICBUYERADDRESS.LIST>
		<CONSIGNEESTATENAME FORMULA="=(null)"/>
		<CONSIGNEEGSTIN FORMULA="=(null)"/>
		<!-- For Sales and Purchase only only -->
		<INVOICEDELNOTES.LIST SCROLL="YES" SKIP="=not(And(Or(len(trim((null)))&gt;0,len(trim((null)))&gt;0),Or(trim(lower((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))))=&quot;sales&quot;,trim(lower((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))))=&quot;purchase&quot;)))">
			<BASICSHIPPINGDATE FORMULA="=(null)"/>
			<BASICSHIPDELIVERYNOTE FORMULA="=(null)"/>
		</INVOICEDELNOTES.LIST>
		<!-- Order list -->
		<!-- For Delivery Note, Sales Invoice, Receipt Note, Purchase Invoice -->
		<INVOICEORDERLIST.LIST SCROLL="YES" SKIP="=Or(len(trim(E#))=0,trim(lower((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))))=&quot;sales order&quot;,trim(lower((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))))=&quot;purchase order&quot;)">
			<BASICORDERDATE FORMULA="=(TEXT(H#, &quot;DD/MM/YYYY&quot;))"/>
			<BASICPURCHASEORDERNO COLUMNREFERENCE="E"/>
		</INVOICEORDERLIST.LIST>
		<!-- Order details -->
		<BASICDUEDATEOFPYMT COLUMNREFERENCE="BX"/>
		<BASICORDERREF COLUMNREFERENCE="BW"/>
		<BASICORDERTERMS.LIST TYPE="String">
			<BASICORDERTERMS FORMULA="=(null)"/>
		</BASICORDERTERMS.LIST>
		<!-- Despatch details -->
		<!-- Despatch Document No -->
		<BASICSHIPDOCUMENTNO FORMULA="=(null)"/>
		<!-- Despatch through -->
		<BASICSHIPPEDBY FORMULA="=(null)"/>
		<!-- Destination -->
		<BASICFINALDESTINATION COLUMNREFERENCE="X"/>
		<BILLOFLADINGNO FORMULA="=(null)"/>
		<BILLOFLADINGDATE FORMULA="=(null)"/>
		<BASICSHIPVESSELNO FORMULA="=(null)"/>
		<!-- Other GST details -->
		<GSTNATUREOFRETURN SKIP="=IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;credit note&quot;,&quot;debit note&quot;\125,0))" FORMULA="=if(len(trim((null)))=0,&quot;01-Sales Return&quot;,(null))"/>
		<VATPARTYTRANSRETURNNUMBER SKIP="=trim((null))=&quot;yes&quot;" FORMULA="=if(len(trim((null)))=0,(if(len(trim(CA#))=0,E#,CA#)),(null))"/>
		<VATPARTYTRANSRETURNDATE SKIP="=trim((null))=&quot;yes&quot;" FORMULA="=if(len(trim((null)))=0,(if(len(trim(CB#))=0,TEXT(H#, &quot;DD/MM/YYYY&quot;),TEXT(CB#, &quot;DD/MM/YYYY&quot;))),(null))"/>
		<URDORIGINALSALEVALUE SKIP="=trim((null))=&quot;yes&quot;" COLUMNREFERENCE="CC"/>
		<!-- Other settings -->
		<ISCANCELLED FORMULA="=(if(D#=&quot;Cancel&quot;,&quot;Yes&quot;,&quot;No&quot;))"/>
		<ISOPTIONAL FORMULA="=(null)"/>
		<!-- Tax Classification at Voucher level -->
		<ISGSTOVERRIDDEN FORMULA="=(null)"/>
		<!-- Party Ledger -->
		<LEDGERENTRIES.LIST SKIP="=And(len(trim((&quot;Amazon India&quot;)))=0,len(trim((null)))=0)" ALTERNATETAGNAME="=if(And(len(trim(N#[1]))=0,len(trim((null)))=0),&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
			<LEDGERNAME FORMULA="=if(len(trim((null)))=0,(&quot;Amazon India&quot;),(null))"/>
			<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;No&quot;,&quot;Yes&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" SKIP="=Not(Round((null)+(null)+(null)+(null),2)=0)" FORMULA="=Round({Round((Abs(AK#)-Abs(BF#)),2)-Round((null),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AH#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AE#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AF#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AG#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AI#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((null),2)}+{Round((Abs(AR#)-Abs(BI#))+(Abs(AY#)-Abs(BL#))+(null)+(null)+(null),2)}+{Round((null)+(null)+(null)+(null)+(null),2)},if(trim((&quot;Yes&quot;))=&quot;yes&quot;,0,2))*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),1,-1)"/>
			<BILLALLOCATIONS.LIST SKIP="=Len(trim(E#))=0" SCROLL="YES">
				<NAME COLUMNREFERENCE="E"/>
				<BILLTYPE FORMULA="=(if(Or(D#=&quot;shipment&quot;,D#=&quot;MFNshipment&quot;),&quot;New Ref&quot;,&quot;Agst Ref&quot;))"/>
				<BILLCREDITPERIOD FORMULA="=(null)"/>
				<AMOUNT CURRENCY="=(null)" ROE="=(null)" SKIP="=Not(Round((null)+(null)+(null)+(null),2)=0)" FORMULA="=Round((Abs(AB#)),2)*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),1,-1)"/>
			</BILLALLOCATIONS.LIST>
			<BILLALLOCATIONS.LIST SKIP="=Or(Len(trim(E#))&gt;0,Len(trim(B#))=0)">
				<NAME FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;debit note&quot;\125,0))),if(len(trim((if(len(trim(CA#))=0,E#,CA#))))=0,B#,(if(len(trim(CA#))=0,E#,CA#))),B#)"/>
				<BILLTYPE>New Ref</BILLTYPE>
				<BILLCREDITPERIOD FORMULA="=(null)"/>
				<AMOUNT CURRENCY="=(null)" ROE="=(null)" SKIP="=Not(Round((null)+(null)+(null)+(null),2)=0)" FORMULA="=Round({Round((Abs(AK#)-Abs(BF#)),2)-Round((null),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AH#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AE#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AF#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AG#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AI#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((null),2)}+{Round((Abs(AR#)-Abs(BI#))+(Abs(AY#)-Abs(BL#))+(null)+(null)+(null),2)}+{Round((null)+(null)+(null)+(null)+(null),2)},if(trim((&quot;Yes&quot;))=&quot;yes&quot;,0,2))*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),1,-1)"/>
			</BILLALLOCATIONS.LIST>
		</LEDGERENTRIES.LIST>
		<!-- GIFT Vouchers in POS -->
		<LEDGERENTRIES.LIST SKIP="=Round((null),2)=0">
			<LEDGERNAME FORMULA="=(null)"/>
			<POSPAYMENTTYPE>Gift</POSPAYMENTTYPE>
			<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;No&quot;,&quot;Yes&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="=Round({Round((null),2)},if(trim((&quot;Yes&quot;))=&quot;yes&quot;,0,2))*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),1,-1)"/>
		</LEDGERENTRIES.LIST>
		<!-- Credit / Debit Card in POS -->
		<LEDGERENTRIES.LIST SKIP="=Round((null),2)=0">
			<LEDGERNAME FORMULA="=(null)"/>
			<POSPAYMENTTYPE>Card</POSPAYMENTTYPE>
			<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;No&quot;,&quot;Yes&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="=Round({Round((null),2)},if(trim((&quot;Yes&quot;))=&quot;yes&quot;,0,2))*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),1,-1)"/>
			<BANKALLOCATIONS.LIST>
				<DATE FORMULA="=(TEXT(C#, &quot;DD/MM/YYYY&quot;))"/>
				<TRANSACTIONTYPE>Others</TRANSACTIONTYPE>
				<PAYMENTFAVOURING FORMULA="=(&quot;Amazon India&quot;)"/>
				<INSTRUMENTNUMBER FORMULA="=(null)"/>
				<STATUS>No</STATUS>
				<PAYMENTMODE>Transacted</PAYMENTMODE>
				<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="=Round({Round((null),2)},if(trim((&quot;Yes&quot;))=&quot;yes&quot;,0,2))*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),1,-1)"/>
				<NAME FORMULA="=+&quot;udi-CARD-&quot; &amp; CZ# &amp; &quot;-&quot; &amp; (if(Or(D#=&quot;shipment&quot;,D#=&quot;MFNshipment&quot;),&quot;Amazon Sales&quot;,if(D#=&quot;Cancel&quot;,&quot;Amazon Cancelled&quot;,&quot;Amazon Credit Note&quot;))) &amp; &quot;-&quot; &amp; (TEXT(C#, &quot;DD/MM/YYYY&quot;))"/>
			</BANKALLOCATIONS.LIST>
		</LEDGERENTRIES.LIST>
		<!-- Bank Ledger in POS -->
		<LEDGERENTRIES.LIST SKIP="=Round((null),2)=0">
			<LEDGERNAME FORMULA="=(null)"/>
			<POSPAYMENTTYPE>Bank</POSPAYMENTTYPE>
			<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;No&quot;,&quot;Yes&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="=Round({Round((null),2)},if(trim((&quot;Yes&quot;))=&quot;yes&quot;,0,2))*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),1,-1)"/>
			<BANKALLOCATIONS.LIST>
				<DATE FORMULA="=(TEXT(C#, &quot;DD/MM/YYYY&quot;))"/>
				<TRANSACTIONTYPE>Cheque/DD</TRANSACTIONTYPE>
				<PAYMENTFAVOURING FORMULA="=(&quot;Amazon India&quot;)"/>
				<BANKNAME FORMULA="=(null)"/>
				<INSTRUMENTNUMBER FORMULA="=(null)"/>
				<STATUS>No</STATUS>
				<PAYMENTMODE>Transacted</PAYMENTMODE>
				<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="=Round({Round((null),2)},if(trim((&quot;Yes&quot;))=&quot;yes&quot;,0,2))*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),1,-1)"/>
				<NAME FORMULA="=+&quot;udi-BANK-&quot; &amp; CZ# &amp; &quot;-&quot; &amp; (if(Or(D#=&quot;shipment&quot;,D#=&quot;MFNshipment&quot;),&quot;Amazon Sales&quot;,if(D#=&quot;Cancel&quot;,&quot;Amazon Cancelled&quot;,&quot;Amazon Credit Note&quot;))) &amp; &quot;-&quot; &amp; (TEXT(C#, &quot;DD/MM/YYYY&quot;))"/>
			</BANKALLOCATIONS.LIST>
		</LEDGERENTRIES.LIST>
		<!-- Cash Ledger in POS -->
		<LEDGERENTRIES.LIST SKIP="=Round((null),2)=0">
			<LEDGERNAME FORMULA="=(null)"/>
			<POSPAYMENTTYPE>Cash</POSPAYMENTTYPE>
			<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;No&quot;,&quot;Yes&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="=Round({Round((null),2)},if(trim((&quot;Yes&quot;))=&quot;yes&quot;,0,2))*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),1,-1)"/>
		</LEDGERENTRIES.LIST>
		<!-- Sales/Purchase Ledger -->
		<LEDGERENTRIES.LIST GROUPBY="=if(Not(And(len(trim(N#))=0,len(trim((null)))=0,Round((Abs(AK#)-Abs(BF#)),2)&lt;&gt;0)),&quot;&quot;,if(len(trim((if(AH#=0,&quot;Sales GST Local&quot;,&quot;Sales GST Interstate&quot;) &amp; ((AE#+AF#+AG#+AH#)*100) &amp; &quot;%&quot;)))=0,if(Round((AH#*100),2)=0,Round((AE#*100),2),Round((AH#*100),2)),trim((if(AH#=0,&quot;Sales GST Local&quot;,&quot;Sales GST Interstate&quot;) &amp; ((AE#+AF#+AG#+AH#)*100) &amp; &quot;%&quot;))))" SCROLL="YES" SKIP="=Not(And(len(trim(N#))=0,len(trim((null)))=0,Round((Abs(AK#)-Abs(BF#)),2)&lt;&gt;0))" ALTERNATETAGNAME="=if(And(len(trim(N#[1]))=0,len(trim((null)))=0),&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
			<LEDGERNAME FORMULA="=if(len(trim((if(AH#=0,&quot;Sales GST Local&quot;,&quot;Sales GST Interstate&quot;) &amp; ((AE#+AF#+AG#+AH#)*100) &amp; &quot;%&quot;)))&gt;0,(if(AH#=0,&quot;Sales GST Local&quot;,&quot;Sales GST Interstate&quot;) &amp; ((AE#+AF#+AG#+AH#)*100) &amp; &quot;%&quot;),if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;debit note&quot;\125,0))),&quot;PURCHASE &quot;,&quot;SALES &quot;) &amp; ((AH#*100)+(AE#*100)+(AF#*100)+(AG#*100)) &amp; &quot;%&quot;)"/>
			<!-- For Invoice Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Not(Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0))))" FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
			<!-- For Voucher Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0)))" FORMULA="=if({Round((Abs(AK#)-Abs(BF#)),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)&lt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="={Round((Abs(AK#)-Abs(BF#)),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
			<!-- Ledger-wise description  -->
			<UDF:USERDESCRIPTION.LIST DESC="`User Description`" ISLIST="YES" TYPE="String" SKIP="=And(len(trim((null)))=0,len(trim((null)))=0,len(trim((null)))=0)">
				<UDF:USERDESCRIPTION DESC="`User Description`" FORMULA="=(null)"/>
				<UDF:USERDESCRIPTION DESC="`User Description`" FORMULA="=(null)"/>
				<UDF:USERDESCRIPTION DESC="`User Description`" FORMULA="=(null)"/>
			</UDF:USERDESCRIPTION.LIST>
			<!-- 
        Tax Classification - Override at Voucher level 
        Applicable to Sales/Purchase with Stockitems only as tested in Tally ERP 9 Release 6.1
        -->
			<GSTOVRDNNATURE SKIP="=trim((null))=&quot;yes&quot;" FORMULA="=(null)"/>
			<GSTOVRDNASSESSABLEVALUE SKIP="=Round((null),2)=0" FORMULA="=Round((null),2)*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
			<RATEDETAILS.LIST SKIP="=trim((null))=&quot;yes&quot;">
				<GSTRATEDUTYHEAD>Integrated Tax</GSTRATEDUTYHEAD>
				<GSTRATEVALUATIONTYPE>Based on Value</GSTRATEVALUATIONTYPE>
				<GSTRATE FORMULA="=(null)"/>
			</RATEDETAILS.LIST>
			<RATEDETAILS.LIST SKIP="=trim((null))=&quot;yes&quot;">
				<GSTRATEDUTYHEAD>Central Tax</GSTRATEDUTYHEAD>
				<GSTRATEVALUATIONTYPE>Based on Value</GSTRATEVALUATIONTYPE>
				<GSTRATE FORMULA="=(null)"/>
			</RATEDETAILS.LIST>
			<RATEDETAILS.LIST SKIP="=trim((null))=&quot;yes&quot;">
				<GSTRATEDUTYHEAD FORMULA="=if(Round((null),2)=0,&quot;State Tax&quot;,&quot;UT Tax&quot;)"/>
				<GSTRATEVALUATIONTYPE>Based on Value</GSTRATEVALUATIONTYPE>
				<GSTRATE FORMULA="=if(Round((null),2)=0,(null),(null))"/>
			</RATEDETAILS.LIST>
			<RATEDETAILS.LIST SKIP="=trim((null))=&quot;yes&quot;">
				<GSTRATEDUTYHEAD>Cess</GSTRATEDUTYHEAD>
				<GSTRATEVALUATIONTYPE>Based on Value</GSTRATEVALUATIONTYPE>
				<GSTRATE FORMULA="=(null)"/>
			</RATEDETAILS.LIST>
			<!-- Cost centre details -->
			<CATEGORYALLOCATIONS.LIST SKIP="=len(trim((null)))=0">
				<CATEGORY FORMULA="=if(len(trim((null)))=0,&quot;Primary Cost Category&quot;,(null))"/>
				<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
				<COSTCENTREALLOCATIONS.LIST>
					<NAME FORMULA="=(null)"/>
					<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="=Round((Abs(AK#)-Abs(BF#)),2)*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
				</COSTCENTREALLOCATIONS.LIST>
			</CATEGORYALLOCATIONS.LIST>
		</LEDGERENTRIES.LIST>
		<!-- Trade discount before taxes -->
		<LEDGERENTRIES.LIST SKIP="={Round((null),2)}=0" ALTERNATETAGNAME="=if(And(len(trim(N#[1]))=0,len(trim((null)))=0),&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
			<LEDGERNAME FORMULA="=if(len(trim((null)))=0,&quot;Discount&quot;,(null))"/>
			<!-- For Invoice Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Not(Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0))))" FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
			<!-- Trade Discount Amount will be always positive. Hence, we need to use the VchType -->
			<!-- For Voucher Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0)))" FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;No&quot;,&quot;Yes&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="={Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),1,-1)"/>
		</LEDGERENTRIES.LIST>
		<!-- Ledger1 before taxes -->
		<LEDGERENTRIES.LIST GROUPBY="=trim((&quot;Shipping Charges @ &quot; &amp; ((AE#+AF#+AG#+AH#)*100) &amp; &quot;%&quot;))" SKIP="={Round((Abs(AR#)-Abs(BI#)),2)}=0" ALTERNATETAGNAME="=if(And(len(trim(N#[1]))=0,len(trim((null)))=0),&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
			<LEDGERNAME FORMULA="=(&quot;Shipping Charges @ &quot; &amp; ((AE#+AF#+AG#+AH#)*100) &amp; &quot;%&quot;)"/>
			<!-- For Invoice Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Not(Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0))))" FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
			<!-- For Voucher Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0)))" FORMULA="=if({Round((Abs(AR#)-Abs(BI#)),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)&lt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="={Round((Abs(AR#)-Abs(BI#)),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
			<!-- Cost centre details -->
			<CATEGORYALLOCATIONS.LIST SKIP="=len(trim((null)))=0">
				<CATEGORY FORMULA="=if(len(trim((null)))=0,&quot;Primary Cost Category&quot;,(null))"/>
				<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
				<COSTCENTREALLOCATIONS.LIST>
					<NAME FORMULA="=(null)"/>
					<AMOUNT FORMULA="={Round((Abs(AR#)-Abs(BI#)),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
				</COSTCENTREALLOCATIONS.LIST>
			</CATEGORYALLOCATIONS.LIST>
		</LEDGERENTRIES.LIST>
		<!-- Ledger2 before taxes -->
		<LEDGERENTRIES.LIST GROUPBY="=trim((&quot;Gift Wrap Charges @&quot; &amp; ((AE#+AF#+AG#+AH#)*100) &amp; &quot;%&quot;))" SKIP="={Round((Abs(AY#)-Abs(BL#)),2)}=0" ALTERNATETAGNAME="=if(And(len(trim(N#[1]))=0,len(trim((null)))=0),&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
			<LEDGERNAME FORMULA="=(&quot;Gift Wrap Charges @&quot; &amp; ((AE#+AF#+AG#+AH#)*100) &amp; &quot;%&quot;)"/>
			<!-- For Invoice Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Not(Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0))))" FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
			<!-- For Voucher Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0)))" FORMULA="=if({Round((Abs(AY#)-Abs(BL#)),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)&lt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="={Round((Abs(AY#)-Abs(BL#)),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
			<!-- Cost centre details -->
			<CATEGORYALLOCATIONS.LIST SKIP="=len(trim((null)))=0">
				<CATEGORY FORMULA="=if(len(trim((null)))=0,&quot;Primary Cost Category&quot;,(null))"/>
				<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
				<COSTCENTREALLOCATIONS.LIST>
					<NAME FORMULA="=(null)"/>
					<AMOUNT FORMULA="={Round((Abs(AY#)-Abs(BL#)),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
				</COSTCENTREALLOCATIONS.LIST>
			</CATEGORYALLOCATIONS.LIST>
		</LEDGERENTRIES.LIST>
		<!-- Ledger3 before taxes -->
		<LEDGERENTRIES.LIST GROUPBY="=trim((null))" SKIP="={Round((null),2)}=0" ALTERNATETAGNAME="=if(And(len(trim(N#[1]))=0,len(trim((null)))=0),&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
			<LEDGERNAME FORMULA="=(null)"/>
			<!-- For Invoice Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Not(Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0))))" FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
			<!-- For Voucher Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0)))" FORMULA="=if({Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)&lt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="={Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
			<!-- Cost centre details -->
			<CATEGORYALLOCATIONS.LIST SKIP="=len(trim((null)))=0">
				<CATEGORY FORMULA="=if(len(trim((null)))=0,&quot;Primary Cost Category&quot;,(null))"/>
				<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
				<COSTCENTREALLOCATIONS.LIST>
					<NAME FORMULA="=(null)"/>
					<AMOUNT FORMULA="={Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
				</COSTCENTREALLOCATIONS.LIST>
			</CATEGORYALLOCATIONS.LIST>
		</LEDGERENTRIES.LIST>
		<!-- Ledger4 before taxes -->
		<LEDGERENTRIES.LIST GROUPBY="=trim((null))" SKIP="={Round((null),2)}=0" ALTERNATETAGNAME="=if(And(len(trim(N#[1]))=0,len(trim((null)))=0),&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
			<LEDGERNAME FORMULA="=(null)"/>
			<!-- For Invoice Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Not(Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0))))" FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
			<!-- For Voucher Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0)))" FORMULA="=if({Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)&lt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="={Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
			<!-- Cost centre details -->
			<CATEGORYALLOCATIONS.LIST SKIP="=len(trim((null)))=0">
				<CATEGORY FORMULA="=if(len(trim((null)))=0,&quot;Primary Cost Category&quot;,(null))"/>
				<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
				<COSTCENTREALLOCATIONS.LIST>
					<NAME FORMULA="=(null)"/>
					<AMOUNT FORMULA="={Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
				</COSTCENTREALLOCATIONS.LIST>
			</CATEGORYALLOCATIONS.LIST>
		</LEDGERENTRIES.LIST>
		<!-- Ledger5 before taxes -->
		<LEDGERENTRIES.LIST GROUPBY="=trim((null))" SKIP="={Round((null),2)}=0" ALTERNATETAGNAME="=if(And(len(trim(N#[1]))=0,len(trim((null)))=0),&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
			<LEDGERNAME FORMULA="=(null)"/>
			<!-- For Invoice Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Not(Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0))))" FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
			<!-- For Voucher Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0)))" FORMULA="=if({Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)&lt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="={Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
			<!-- Cost centre details -->
			<CATEGORYALLOCATIONS.LIST SKIP="=len(trim((null)))=0">
				<CATEGORY FORMULA="=if(len(trim((null)))=0,&quot;Primary Cost Category&quot;,(null))"/>
				<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
				<COSTCENTREALLOCATIONS.LIST>
					<NAME FORMULA="=(null)"/>
					<AMOUNT FORMULA="={Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
				</COSTCENTREALLOCATIONS.LIST>
			</CATEGORYALLOCATIONS.LIST>
		</LEDGERENTRIES.LIST>
		<!-- IGST Ledger -->
		<LEDGERENTRIES.LIST GROUPBY="=if(len(trim((null)))=0,trim((AH#*100)),trim((null)))" SKIP="={Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AH#/(AE#+AF#+AG#+AH#+AI#))),2)}=0" ALTERNATETAGNAME="=if(And(len(trim(N#[1]))=0,len(trim((null)))=0),&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
			<LEDGERNAME FORMULA="=if(len(trim((null)))&gt;0,(null),if(Or(IsError(Round((AH#*100),2)),len(trim((AH#*100)))=0,(AH#*100)=0),&quot;&quot;,&quot;IGST &quot; &amp; (AH#*100) &amp; &quot;%&quot;))"/>
			<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="={Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AH#/(AE#+AF#+AG#+AH#+AI#))),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
		</LEDGERENTRIES.LIST>
		<!-- CGST Ledger -->
		<LEDGERENTRIES.LIST GROUPBY="=if(len(trim((null)))=0,trim((AE#*100)),trim((null)))" SKIP="={Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AE#/(AE#+AF#+AG#+AH#+AI#))),2)}=0" ALTERNATETAGNAME="=if(And(len(trim(N#[1]))=0,len(trim((null)))=0),&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
			<LEDGERNAME FORMULA="=if(len(trim((null)))&gt;0,(null),if(Or(IsError(Round((AE#*100),2)),len(trim((AE#*100)))=0,(AE#*100)=0),&quot;&quot;,&quot;CGST &quot; &amp; (AE#*100) &amp; &quot;%&quot;))"/>
			<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="={Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AE#/(AE#+AF#+AG#+AH#+AI#))),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
		</LEDGERENTRIES.LIST>
		<!-- SGST Ledger -->
		<LEDGERENTRIES.LIST GROUPBY="=if(len(trim((null)))=0,trim((AF#*100)),trim((null)))" SKIP="={Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AF#/(AE#+AF#+AG#+AH#+AI#))),2)}=0" ALTERNATETAGNAME="=if(And(len(trim(N#[1]))=0,len(trim((null)))=0),&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
			<LEDGERNAME FORMULA="=if(len(trim((null)))&gt;0,(null),if(Or(IsError(Round((AF#*100),2)),len(trim((AF#*100)))=0,(AF#*100)=0),&quot;&quot;,&quot;SGST &quot; &amp; (AF#*100) &amp; &quot;%&quot;))"/>
			<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="={Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AF#/(AE#+AF#+AG#+AH#+AI#))),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
		</LEDGERENTRIES.LIST>
		<!-- UT Ledger -->
		<LEDGERENTRIES.LIST GROUPBY="=if(len(trim((null)))=0,trim((AG#*100)),trim((null)))" SKIP="={Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AG#/(AE#+AF#+AG#+AH#+AI#))),2)}=0" ALTERNATETAGNAME="=if(And(len(trim(N#[1]))=0,len(trim((null)))=0),&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
			<LEDGERNAME FORMULA="=if(len(trim((null)))&gt;0,(null),if(Or(IsError(Round((AG#*100),2)),len(trim((AG#*100)))=0,(AG#*100)=0),&quot;&quot;,&quot;UT &quot; &amp; (AG#*100) &amp; &quot;%&quot;))"/>
			<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="={Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AG#/(AE#+AF#+AG#+AH#+AI#))),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
		</LEDGERENTRIES.LIST>
		<!-- Cess Ledger -->
		<LEDGERENTRIES.LIST GROUPBY="=if(len(trim((null)))=0,trim((AI#*100)),trim((null)))" SKIP="={Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AI#/(AE#+AF#+AG#+AH#+AI#))),2)}=0" ALTERNATETAGNAME="=if(And(len(trim(N#[1]))=0,len(trim((null)))=0),&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
			<LEDGERNAME FORMULA="=if(len(trim((null)))&gt;0,(null),if(Or(IsError(Round((AI#*100),2)),len(trim((AI#*100)))=0,(AI#*100)=0),&quot;&quot;,&quot;Cess &quot; &amp; (AI#*100) &amp; &quot;%&quot;))"/>
			<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="={Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AI#/(AE#+AF#+AG#+AH#+AI#))),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
		</LEDGERENTRIES.LIST>
		<!-- Addl Cess Ledger -->
		<LEDGERENTRIES.LIST GROUPBY="=if(len(trim((null)))=0,trim((null)),trim((null)))" SKIP="={Round((null),2)}=0" ALTERNATETAGNAME="=if(And(len(trim(N#[1]))=0,len(trim((null)))=0),&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
			<LEDGERNAME FORMULA="=if(len(trim((null)))&gt;0,(null),if(Or(IsError(Round((null),2)),len(trim((null)))=0,(null)=0),&quot;&quot;,&quot;Addl Cess - &quot; &amp; (null)))"/>
			<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="={Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
		</LEDGERENTRIES.LIST>
		<!-- Ledger1 -->
		<LEDGERENTRIES.LIST GROUPBY="=trim((null))" SKIP="={Round((null),2)}=0" ALTERNATETAGNAME="=if(And(len(trim(N#[1]))=0,len(trim((null)))=0),&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
			<LEDGERNAME FORMULA="=(null)"/>
			<!-- For Invoice Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Not(Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0))))" FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
			<!-- For Voucher Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0)))" FORMULA="=if({Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)&lt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="={Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
			<!-- Cost centre details -->
			<CATEGORYALLOCATIONS.LIST SKIP="=len(trim((null)))=0">
				<CATEGORY FORMULA="=if(len(trim((null)))=0,&quot;Primary Cost Category&quot;,(null))"/>
				<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
				<COSTCENTREALLOCATIONS.LIST>
					<NAME FORMULA="=(null)"/>
					<AMOUNT FORMULA="={Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
				</COSTCENTREALLOCATIONS.LIST>
			</CATEGORYALLOCATIONS.LIST>
		</LEDGERENTRIES.LIST>
		<!-- Ledger2 -->
		<LEDGERENTRIES.LIST GROUPBY="=trim((null))" SKIP="={Round((null),2)}=0" ALTERNATETAGNAME="=if(And(len(trim(N#[1]))=0,len(trim((null)))=0),&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
			<LEDGERNAME FORMULA="=(null)"/>
			<!-- For Invoice Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Not(Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0))))" FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
			<!-- For Voucher Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0)))" FORMULA="=if({Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)&lt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="={Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
			<!-- Cost centre details -->
			<CATEGORYALLOCATIONS.LIST SKIP="=len(trim((null)))=0">
				<CATEGORY FORMULA="=if(len(trim((null)))=0,&quot;Primary Cost Category&quot;,(null))"/>
				<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
				<COSTCENTREALLOCATIONS.LIST>
					<NAME FORMULA="=(null)"/>
					<AMOUNT FORMULA="={Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
				</COSTCENTREALLOCATIONS.LIST>
			</CATEGORYALLOCATIONS.LIST>
		</LEDGERENTRIES.LIST>
		<!-- Ledger3 -->
		<LEDGERENTRIES.LIST GROUPBY="=trim((null))" SKIP="={Round((null),2)}=0" ALTERNATETAGNAME="=if(And(len(trim(N#[1]))=0,len(trim((null)))=0),&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
			<LEDGERNAME FORMULA="=(null)"/>
			<!-- For Invoice Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Not(Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0))))" FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
			<!-- For Voucher Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0)))" FORMULA="=if({Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)&lt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="={Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
			<!-- Cost centre details -->
			<CATEGORYALLOCATIONS.LIST SKIP="=len(trim((null)))=0">
				<CATEGORY FORMULA="=if(len(trim((null)))=0,&quot;Primary Cost Category&quot;,(null))"/>
				<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
				<COSTCENTREALLOCATIONS.LIST>
					<NAME FORMULA="=(null)"/>
					<AMOUNT FORMULA="={Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
				</COSTCENTREALLOCATIONS.LIST>
			</CATEGORYALLOCATIONS.LIST>
		</LEDGERENTRIES.LIST>
		<!-- Ledger4 -->
		<LEDGERENTRIES.LIST GROUPBY="=trim((null))" SKIP="={Round((null),2)}=0" ALTERNATETAGNAME="=if(And(len(trim(N#[1]))=0,len(trim((null)))=0),&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
			<LEDGERNAME FORMULA="=(null)"/>
			<!-- For Invoice Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Not(Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0))))" FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
			<!-- For Voucher Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0)))" FORMULA="=if({Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)&lt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="={Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
			<!-- Cost centre details -->
			<CATEGORYALLOCATIONS.LIST SKIP="=len(trim((null)))=0">
				<CATEGORY FORMULA="=if(len(trim((null)))=0,&quot;Primary Cost Category&quot;,(null))"/>
				<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
				<COSTCENTREALLOCATIONS.LIST>
					<NAME FORMULA="=(null)"/>
					<AMOUNT FORMULA="={Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
				</COSTCENTREALLOCATIONS.LIST>
			</CATEGORYALLOCATIONS.LIST>
		</LEDGERENTRIES.LIST>
		<!-- Ledger5 -->
		<LEDGERENTRIES.LIST GROUPBY="=trim((null))" SKIP="={Round((null),2)}=0" ALTERNATETAGNAME="=if(And(len(trim(N#[1]))=0,len(trim((null)))=0),&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
			<LEDGERNAME FORMULA="=(null)"/>
			<!-- For Invoice Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Not(Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0))))" FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
			<!-- For Voucher Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0)))" FORMULA="=if({Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)&lt;0,&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="={Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
			<!-- Cost centre details -->
			<CATEGORYALLOCATIONS.LIST SKIP="=len(trim((null)))=0">
				<CATEGORY FORMULA="=if(len(trim((null)))=0,&quot;Primary Cost Category&quot;,(null))"/>
				<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
				<COSTCENTREALLOCATIONS.LIST>
					<NAME FORMULA="=(null)"/>
					<AMOUNT FORMULA="={Round((null),2)}*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
				</COSTCENTREALLOCATIONS.LIST>
			</CATEGORYALLOCATIONS.LIST>
		</LEDGERENTRIES.LIST>
		<!-- Round Off Ledger -->
		<LEDGERENTRIES.LIST SKIP="=Or(Not(trim((&quot;Yes&quot;))=&quot;yes&quot;),Round(Round({Round((Abs(AK#)-Abs(BF#)),2)-Round((null),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AH#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AE#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AF#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AG#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AI#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((null),2)}+{Round((Abs(AR#)-Abs(BI#))+(Abs(AY#)-Abs(BL#))+(null)+(null)+(null),2)}+{Round((null)+(null)+(null)+(null)+(null),2)},0)-Round({Round((Abs(AK#)-Abs(BF#)),2)-Round((null),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AH#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AE#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AF#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AG#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AI#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((null),2)}+{Round((Abs(AR#)-Abs(BI#))+(Abs(AY#)-Abs(BL#))+(null)+(null)+(null),2)}+{Round((null)+(null)+(null)+(null)+(null),2)},2),2)=0)" ALTERNATETAGNAME="=if(And(len(trim(N#[1]))=0,len(trim((null)))=0),&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
			<LEDGERNAME FORMULA="=if(len(trim((null)))=0,&quot;Round Off&quot;,(null))"/>
			<!-- 
      When the value for IsInvoiceMode is set explicitly set to Yes 
      And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;)

      When the value of IsInvoiceMode is deemed to be Yes 
      And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0))
      -->
			<!-- For Invoice Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Not(Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0))))" FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
			<!-- For Voucher Mode -->
			<ISDEEMEDPOSITIVE SKIP="=Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0)))" FORMULA="=if(Round(Round({Round((Abs(AK#)-Abs(BF#)),2)-Round((null),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AH#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AE#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AF#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AG#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AI#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((null),2)}+{Round((Abs(AR#)-Abs(BI#))+(Abs(AY#)-Abs(BL#))+(null)+(null)+(null),2)}+{Round((null)+(null)+(null)+(null)+(null),2)},0)-Round({Round((Abs(AK#)-Abs(BF#)),2)-Round((null),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AH#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AE#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AF#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AG#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AI#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((null),2)}+{Round((Abs(AR#)-Abs(BI#))+(Abs(AY#)-Abs(BL#))+(null)+(null)+(null),2)}+{Round((null)+(null)+(null)+(null)+(null),2)},2),2)*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)&gt;0,&quot;No&quot;,&quot;Yes&quot;)"/>
			<!-- For Invoice Mode -->
			<TEST SKIP="=Not(Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0))))">ISINVOICEMODE=YES</TEST>
			<!-- For Voucher Mode -->
			<TEST SKIP="=Or(And(Len(trim((null)))&gt;0,trim((null))=&quot;Yes&quot;),And(Len(trim((null)))=0,Or(len(trim(N#[1]))&gt;0,len(trim((null)))&gt;0)))">ISINVOICEMODE=NO</TEST>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="=Round(Round({Round((Abs(AK#)-Abs(BF#)),2)-Round((null),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AH#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AE#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AF#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AG#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AI#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((null),2)}+{Round((Abs(AR#)-Abs(BI#))+(Abs(AY#)-Abs(BL#))+(null)+(null)+(null),2)}+{Round((null)+(null)+(null)+(null)+(null),2)},0)-Round({Round((Abs(AK#)-Abs(BF#)),2)-Round((null),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AH#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AE#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AF#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AG#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((if((AE#+AF#+AG#+AH#+AI#)=0,0,Abs(AD#)*AI#/(AE#+AF#+AG#+AH#+AI#))),2)+Round((null),2)}+{Round((Abs(AR#)-Abs(BI#))+(Abs(AY#)-Abs(BL#))+(null)+(null)+(null),2)}+{Round((null)+(null)+(null)+(null)+(null),2)},2),2)*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
		</LEDGERENTRIES.LIST>
		<!-- StockItems -->
		<ALLINVENTORYENTRIES.LIST SCROLL="YES" SKIP="=And(len(trim(N#))=0,len(trim((null)))=0)">
			<BASICUSERDESCRIPTION.LIST SKIP="=And(len(trim((null)))=0,len(trim((null)))=0,len(trim((null)))=0)">
				<BASICUSERDESCRIPTION FORMULA="=(null)"/>
				<BASICUSERDESCRIPTION FORMULA="=(null)"/>
				<BASICUSERDESCRIPTION FORMULA="=(null)"/>
			</BASICUSERDESCRIPTION.LIST>
			<STOCKITEMNAME FORMULA="=if(len(trim((null)))=0,N#,(null))"/>
			<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
			<RATE SKIP="=Or((null)=&quot;yes&quot;,And(len(trim((null)))&gt;0,len(trim((null)))&gt;0))" FORMULA="=(Abs(if(J#&gt;1,Abs(AK#)-Abs(BF#)/J#,Abs(AK#)-Abs(BF#))))"/>
			<RATE SKIP="=Or(Not((null)=&quot;yes&quot;),And(len(trim((null)))&gt;0,len(trim((null)))&gt;0))" FORMULA="=(Abs(if(J#&gt;1,Abs(AK#)-Abs(BF#)/J#,Abs(AK#)-Abs(BF#)))) &amp; &quot;/&quot; &amp; (&quot;Nos&quot;)"/>
			<DISCOUNT FORMULA="=(null)"/>
			<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="=Round((Abs(AK#)-Abs(BF#)),2)*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
			<ACTUALQTY SKIP="=(null)=&quot;yes&quot;" FORMULA="=if(len(trim((null)))=0,J#,(null))"/>
			<BILLEDQTY SKIP="=(null)=&quot;yes&quot;" COLUMNREFERENCE="J"/>
			<ACTUALQTY SKIP="=Not((null)=&quot;yes&quot;)" FORMULA="=if(len(trim((null)))=0,J#,(null)) &amp; &quot; &quot; &amp; (&quot;Nos&quot;)"/>
			<BILLEDQTY SKIP="=Not((null)=&quot;yes&quot;)" FORMULA="=J# &amp; &quot; &quot; &amp; (&quot;Nos&quot;)"/>
			<ACCOUNTINGALLOCATIONS.LIST>
				<LEDGERNAME FORMULA="=if(len(trim((if(AH#=0,&quot;Sales GST Local&quot;,&quot;Sales GST Interstate&quot;) &amp; ((AE#+AF#+AG#+AH#)*100) &amp; &quot;%&quot;)))&gt;0,(if(AH#=0,&quot;Sales GST Local&quot;,&quot;Sales GST Interstate&quot;) &amp; ((AE#+AF#+AG#+AH#)*100) &amp; &quot;%&quot;),if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;debit note&quot;\125,0))),&quot;PURCHASE &quot;,&quot;SALES &quot;) &amp; ((AH#*100)+(AE#*100)+(AF#*100)+(AG#*100)) &amp; &quot;%&quot;)"/>
				<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
				<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="=Round((Abs(AK#)-Abs(BF#)),2)*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
				<!-- 
        Tax Classification - Override at Voucher level 
        Applicable to Sales/Purchase with Stockitems only as tested in Tally ERP 9 Release 6.1
        -->
				<GSTOVRDNNATURE SKIP="=trim((null))=&quot;yes&quot;" FORMULA="=(null)"/>
				<GSTOVRDNASSESSABLEVALUE SKIP="=Round((null),2)=0" FORMULA="=Round((null),2)*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
				<RATEDETAILS.LIST SKIP="=trim((null))=&quot;yes&quot;">
					<GSTRATEDUTYHEAD>Integrated Tax</GSTRATEDUTYHEAD>
					<GSTRATEVALUATIONTYPE>Based on Value</GSTRATEVALUATIONTYPE>
					<GSTRATE FORMULA="=(null)"/>
				</RATEDETAILS.LIST>
				<RATEDETAILS.LIST SKIP="=trim((null))=&quot;yes&quot;">
					<GSTRATEDUTYHEAD>Central Tax</GSTRATEDUTYHEAD>
					<GSTRATEVALUATIONTYPE>Based on Value</GSTRATEVALUATIONTYPE>
					<GSTRATE FORMULA="=(null)"/>
				</RATEDETAILS.LIST>
				<RATEDETAILS.LIST SKIP="=trim((null))=&quot;yes&quot;">
					<GSTRATEDUTYHEAD FORMULA="=if(Round((null),2)=0,&quot;State Tax&quot;,&quot;UT Tax&quot;)"/>
					<GSTRATEVALUATIONTYPE>Based on Value</GSTRATEVALUATIONTYPE>
					<GSTRATE FORMULA="=if(Round((null),2)=0,(null),(null))"/>
				</RATEDETAILS.LIST>
				<RATEDETAILS.LIST SKIP="=trim((null))=&quot;yes&quot;">
					<GSTRATEDUTYHEAD>Cess</GSTRATEDUTYHEAD>
					<GSTRATEVALUATIONTYPE SKIP="=Not(Or(Round((null),2)=0,Round((null),2)=0))">Based on Value</GSTRATEVALUATIONTYPE>
					<GSTRATEVALUATIONTYPE SKIP="=Or(Round((null),2)=0,Round((null),2)=0)">Based on Value and Quantity</GSTRATEVALUATIONTYPE>
					<GSTRATE FORMULA="=(null)"/>
				</RATEDETAILS.LIST>
				<!-- Cost centre details -->
				<CATEGORYALLOCATIONS.LIST SKIP="=len(trim((null)))=0">
					<CATEGORY FORMULA="=if(len(trim((null)))=0,&quot;Primary Cost Category&quot;,(null))"/>
					<ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
					<COSTCENTREALLOCATIONS.LIST>
						<NAME FORMULA="=(null)"/>
						<AMOUNT FORMULA="=Round((Abs(AK#)-Abs(BF#)),2)*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
					</COSTCENTREALLOCATIONS.LIST>
				</CATEGORYALLOCATIONS.LIST>
			</ACCOUNTINGALLOCATIONS.LIST>
			<BATCHALLOCATIONS.LIST>
				<!-- Godown details -->
				<GODOWNNAME FORMULA="=if(len(trim(BV#))=0,&quot;Main Location&quot;,BV#)"/>
				<DESTINATIONGODOWNNAME FORMULA="=if(len(trim(BV#))=0,&quot;Main Location&quot;,BV#)"/>
				<!-- Batch details -->
				<BATCHNAME FORMULA="=if(len(trim((null)))=0,&quot;Primary Batch&quot;,(null))"/>
				<MFDON SKIP="=Len(trim((null)))=0" FORMULA="=(null)"/>
				<EXPIRYPERIOD SKIP="=Len(trim((null)))=0" FORMULA="=(null)"/>
				<AMOUNT CURRENCY="=(null)" ROE="=(null)" FORMULA="=Round((Abs(AK#)-Abs(BF#)),2)*if(Not(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;payment&quot;,&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
				<ACTUALQTY FORMULA="=if(len(trim((null)))=0,J#,(null))"/>
				<BILLEDQTY COLUMNREFERENCE="J"/>
				<!-- For Sales Order and Purchase Order - Column (if(len(trim(CA#))=0,E#,CA#)) -->
				<!-- For Delivery Note, Sales Invoice, Receipt Note, Purchase Invoice - Column E# -->
				<ORDERNO FORMULA="=if(Or(trim(lower((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))))=&quot;sales order&quot;,trim(lower((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))))=&quot;purchase order&quot;),(if(len(trim(CA#[1]))=0,E#[1],CA#[1])),E#[1])"/>
				<!-- For Sales Order and Purchase Order - Column (TEXT(C#, &quot;DD/MM/YYYY&quot;)) -->
				<!-- For Delivery Note, Sales Invoice, Receipt Note, Purchase Invoice - Column (TEXT(H#, &quot;DD/MM/YYYY&quot;)) -->
				<ORDERDUEDATE FORMULA="=if(Or(trim(lower((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))))=&quot;sales order&quot;,trim(lower((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))))=&quot;purchase order&quot;),(TEXT(C#[1], &quot;DD/MM/YYYY&quot;)),(TEXT(H#[1], &quot;DD/MM/YYYY&quot;)))"/>
				<!-- For Delivery Note, Sales Invoice, Receipt Note, Purchase Invoice -->
				<TRACKINGNUMBER SKIP="if(IsError(Match(trim((if(Or(D#[1]=&quot;shipment&quot;,D#[1]=&quot;MFNshipment&quot;,D#[1]=&quot;Cancel&quot;),&quot;Sales&quot;,&quot;Credit Note&quot;))),\123&quot;delivery note&quot;,&quot;sales&quot;,&quot;receipt note&quot;,&quot;purchase&quot;\125,0)),-1,1)" FORMULA="=(null)"/>
			</BATCHALLOCATIONS.LIST>
			<UDF:EIDISCOUNTRATE.LIST SKIP="=Round((null),2)=0" DESC="`EI DiscountRate`" ISLIST="YES" TYPE="Number" INDEX="10001">
				<UDF:EIDISCOUNTRATE DESC="`EI DiscountRate`" FORMULA="=(null)"/>
			</UDF:EIDISCOUNTRATE.LIST>
			<UDF:EIDISCOUNTAMT.LIST SKIP="=Round((null),2)=0" DESC="`EI DiscountAmt`" ISLIST="YES" TYPE="Amount" INDEX="10003">
				<UDF:EIDISCOUNTAMT DESC="`EI DiscountAmt`" FORMULA="=(null)"/>
			</UDF:EIDISCOUNTAMT.LIST>
		</ALLINVENTORYENTRIES.LIST>
	</VOUCHER10>
</XMLTAGS>

